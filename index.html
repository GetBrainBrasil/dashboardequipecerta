<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Indicadores A&S - Pierre Fabre 2025</title>

  <!-- Tipografia -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet"/>

  <!-- Libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer></script>

  <style>
    :root{
      --bg: #f6f7f9;
      --card: #ffffff;
      --muted: #6b7280;          /* cinza m√©dio */
      --line: #e5e7eb;           /* borda suave */

      --brand: #7c3aed;          /* violeta */
      --brand-600: #6d28d9;
      --brand-100: #ede9fe;

      --accent: #06b6d4;         /* ciano */
      --accent-100: #ecfeff;

      --success: #16a34a;
      --warning: #f59e0b;
      --error:   #ef4444;

      --shadow: 0 6px 24px rgba(2,6,23,0.06);
      --radius-xl: 16px;
      --radius-lg: 12px;
      --radius-md: 10px;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color:#0f172a;
      line-height:1.4;
      padding:24px;
    }

    /* Bot√£o imprimir */
    .print-button{
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--brand);
      color:#fff;
      border:none;
      padding: 10px 18px;
      border-radius: 999px;
      font-size: 15px;
      font-weight: 600;
      cursor:pointer;
      box-shadow: var(--shadow);
      transition: transform .15s ease, filter .15s ease;
      z-index: 1000;
    }
    .print-button:hover{ transform: translateY(-1px); filter: brightness(1.05); }

    /* Header */
    .header{
      max-width: 1200px;
      margin: 60px auto 28px;
      background: linear-gradient(180deg, var(--card), #fafbff);
      border: 1px solid var(--line);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow);
      padding: 32px 28px;
    }
    .brand-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom: 8px;
    }
    .logo{
      display:inline-flex;
      align-items:center;
      gap:10px;
      background: linear-gradient(90deg, var(--brand-100), var(--accent-100));
      border: 1px solid var(--line);
      color: var(--brand-600);
      padding: 8px 14px;
      border-radius: 10px;
      font-weight: 800;
      letter-spacing: 0.3px;
    }
    .logo .dot{
      width:10px;height:10px;border-radius:50%;background: var(--brand);
      box-shadow: 0 0 0 3px #ede9fe inset;
    }

    .header h1{
      font-size: 32px;
      font-weight: 800;
      letter-spacing:-0.02em;
      color:#0b1324;
      margin:6px 0 2px;
    }
    .header h2{
      font-size: 18px;
      font-weight: 600;
      color: var(--brand-600);
      letter-spacing: .2px;
      margin-bottom: 6px;
    }
    .header p{ color: var(--muted); font-size: 14px; }

    /* Container */
    .dashboard-container{
      max-width: 1200px;
      margin: 0 auto 60px;
    }

    .section-title{
      margin: 26px 0 14px;
      font-size: 18px;
      font-weight: 700;
      color:#0b1324;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .section-title::after{
      content:"";
      flex:1;
      height:1px;
      background: var(--line);
      opacity:.8;
    }

    .metrics-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px,1fr));
      gap: 18px;
      margin-bottom: 22px;
    }
    .metric-card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      padding: 18px;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .metric-card:hover{ transform: translateY(-2px); box-shadow: 0 8px 28px rgba(2,6,23,0.08); }
    .metric-card h3{
      font-size: 14px;
      color:#111827;
      font-weight: 700;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px dashed var(--line);
    }

    .chart-container{ position: relative; height: 300px; width:100%; }

    /* Cards de stats (Resumo Executivo) */
    .stat-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(160px,1fr));
      gap:14px;
    }
    .stat-box{
      background: linear-gradient(135deg, var(--brand), var(--accent));
      color:#fff;
      padding:18px;
      border-radius: var(--radius-md);
      position:relative;
      overflow:hidden;
      isolation:isolate;
    }
    .stat-box::after{
      content:"";
      position:absolute; inset:auto -30px -30px auto;
      width:120px; height:120px; border-radius:50%;
      background: rgba(255,255,255,.15); filter: blur(10px);
      z-index:-1;
    }
    .stat-number{ font-size: 28px; font-weight: 800; letter-spacing: -0.02em; }
    .stat-label{ font-size: 12px; opacity: .95; margin-top:4px; font-weight:600; letter-spacing:.3px; }

    /* Diversidade */
    .diversity-indicators{
      display:flex; flex-wrap:wrap; gap:16px; padding: 6px 2px; justify-content:space-between;
    }
    .diversity-item{ text-align:center; flex:1; min-width:140px; }
    .diversity-icon{
      width:60px; height:60px; margin: 0 auto 8px; border-radius: 14px;
      display:grid; place-items:center; color:#fff; font-size:24px;
      background: linear-gradient(135deg, var(--brand), var(--accent));
      box-shadow: var(--shadow);
    }
    .diversity-value{ font-size: 26px; font-weight: 800; color:#0b1324; margin: 8px 0 2px; }
    .diversity-label{ font-size: 12px; color: var(--muted); letter-spacing:.3px; }

    /* Tabela */
    .table-container{ overflow-x:auto; margin-top: 10px; }
    table{ width:100%; border-collapse: collapse; }
    th, td{ padding:12px; text-align:left; border-bottom:1px solid var(--line); }
    th{
      background: linear-gradient(180deg, #fafbff, #f4f6fb);
      color:#111827;
      font-weight: 700;
      font-size: 13px;
    }
    td{ font-size: 13px; color:#111827; }

    tr:hover{ background:#f9fafb; }

    /* Legenda (se usar) */
    .legend{ display:flex; justify-content:center; flex-wrap:wrap; gap:14px; margin-top:10px; }
    .legend-item{ display:flex; align-items:center; gap:8px; font-size:13px; color:#111827; }
    .legend-color{ width:16px; height:16px; border-radius:4px; outline:1px solid #0001; }

    /* Print */
    @media print{
      body{ background:#fff; padding:0; }
      .print-button{ display:none; }
      .header{
        box-shadow:none; border:none; background:#fff;
        margin: 0 0 18px; border-bottom: 1px solid var(--line); border-radius: 0;
      }
      .header h1{ color:#0b1324; }
      .section-title{ color:#0b1324; }
      .metric-card{ break-inside: avoid; box-shadow:none; }
    }
  </style>
</head>
<body>
  <button class="print-button" onclick="window.print()">üìÑ Exportar PDF</button>

  <header class="header">
    <div class="brand-row">
      <div class="logo">
        <span class="dot"></span>
        <span>Pierre&nbsp;Fabre</span>
      </div>
      <p style="font-size:13px;color:var(--muted)">Atualizado em: Outubro 2025</p>
    </div>
    <h1>Indicadores A&amp;S</h1>
    <h2>Processos Seletivos ‚Äî 2025</h2>
  </header>

  <main class="dashboard-container">
    <!-- Resumo Executivo -->
    <section>
      <h2 class="section-title">üìä Resumo Executivo</h2>
      <div class="stat-grid">
        <div class="stat-box">
          <div class="stat-number">128</div>
          <div class="stat-label">Total de Vagas</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">93</div>
          <div class="stat-label">Contrata√ß√µes</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">72.7%</div>
          <div class="stat-label">Taxa de Convers√£o</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">16</div>
          <div class="stat-label">Em Andamento</div>
        </div>
      </div>
    </section>

    <!-- Volumetria dos Processos -->
    <section>
      <h2 class="section-title">üìà Volumetria dos Processos</h2>
      <div class="metrics-grid">
        <div class="metric-card">
          <h3>Status das Requisi√ß√µes</h3>
          <div class="chart-container"><canvas id="statusReqChart"></canvas></div>
        </div>

        <div class="metric-card">
          <h3>Status dos Processos</h3>
          <div class="chart-container"><canvas id="statusProcChart"></canvas></div>
        </div>

        <div class="metric-card">
          <h3>Vagas por Local</h3>
          <div class="chart-container"><canvas id="localChart"></canvas></div>
        </div>

        <div class="metric-card">
          <h3>Perfil das Vagas</h3>
          <div class="chart-container"><canvas id="nivelChart"></canvas></div>
        </div>
      </div>
    </section>

    <!-- Distribui√ß√£o por √Årea -->
    <section>
      <h2 class="section-title">üè¢ Distribui√ß√£o por Diretoria</h2>
      <div class="metric-card">
        <h3>Top 10 Diretorias com Mais Vagas</h3>
        <div class="chart-container" style="height:400px"><canvas id="diretoriaChart"></canvas></div>
      </div>
    </section>

    <!-- Diversidade e Inclus√£o -->
    <section>
      <h2 class="section-title">üåà Diversidade e Inclus√£o</h2>
      <div class="metric-card">
        <h3>Indicadores de Diversidade nas Contrata√ß√µes</h3>
        <div class="diversity-indicators">
          <div class="diversity-item">
            <div class="diversity-icon">üë©</div>
            <div class="diversity-value">13</div>
            <div class="diversity-label">MULHERES</div>
            <div style="color: var(--brand); font-size: 12px;">14% do total</div>
          </div>
          <div class="diversity-item">
            <div class="diversity-icon">ü§ù</div>
            <div class="diversity-value">17</div>
            <div class="diversity-label">RA√áA</div>
            <div style="color: var(--brand); font-size: 12px;">18.3% do total</div>
          </div>
          <div class="diversity-item">
            <div class="diversity-icon">‚ôø</div>
            <div class="diversity-value">0</div>
            <div class="diversity-label">PCD</div>
            <div style="color: var(--error); font-size: 12px;">0% do total</div>
          </div>
          <div class="diversity-item">
            <div class="diversity-icon">üë¥</div>
            <div class="diversity-value">5</div>
            <div class="diversity-label">50+</div>
            <div style="color: var(--brand); font-size: 12px;">5.4% do total</div>
          </div>
        </div>

        <div class="chart-container" style="height:300px;margin-top:24px">
          <canvas id="diversityChart"></canvas>
        </div>
      </div>
    </section>

    <!-- An√°lise Detalhada -->
    <section>
      <h2 class="section-title">üìã An√°lise Detalhada</h2>
      <div class="metrics-grid">
        <div class="metric-card">
          <h3>Taxa de Aprova√ß√£o por Status</h3>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Status</th>
                  <th>Quantidade</th>
                  <th>Percentual</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>Contratada</td><td>93</td><td>72.7%</td></tr>
                <tr><td>Congelada</td><td>16</td><td>12.5%</td></tr>
                <tr><td>Cancelada</td><td>16</td><td>12.5%</td></tr>
                <tr><td>Decl√≠nio de Oferta</td><td>2</td><td>1.6%</td></tr>
                <tr><td>Em Processo</td><td>1</td><td>0.8%</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="metric-card">
          <h3>Principais M√©tricas de Performance</h3>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>M√©trica</th>
                  <th>Valor</th>
                  <th>Meta</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>Taxa de Convers√£o</td><td>72.7%</td><td>70%</td><td style="color: var(--success); font-weight:700">‚úì Atingido</td></tr>
                <tr><td>Diversidade G√™nero</td><td>14%</td><td>30%</td><td style="color: var(--warning); font-weight:700">‚ö† Em progresso</td></tr>
                <tr><td>Inclus√£o PCD</td><td>0%</td><td>5%</td><td style="color: var(--error); font-weight:700">‚úó Abaixo da meta</td></tr>
                <tr><td>Taxa de Cancelamento</td><td>12.5%</td><td>15%</td><td style="color: var(--success); font-weight:700">‚úì Dentro do esperado</td></tr>
              </tbody>
            </table>
          </div>
        </div>

      </div>
    </section>
  </main>

  <script>
    // ====== CONFIG GERAL CHART.JS ======
    Chart.defaults.font.family = "'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif";
    Chart.defaults.plugins.legend.labels.boxWidth = 14;

    // ====== DADOS (mantidos) ======
    const data = {
      statusRequisicao: { Aprovada: 56, Cancelada: 4, Preenchida: 68 },
      statusProcesso: {
        Contratada: 93, Congelada: 16, Cancelada: 16,
        'Decl√≠nio de carta oferta': 2, 'Em Processo': 1
      },
      local: { Escrit√≥rio: 72, Campo: 29, BIC: 13, F√°brica: 12, 'N√£o especificado': 2 },
      nivel: {
        Est√°gio: 41, Analista: 27, Vendas: 19, Gerencial: 12, Especialista: 10,
        'Jovem Aprendiz': 10, 'Supervis√£o/Coordena√ß√£o': 6, 'Demais vagas': 1, 'N√£o especificado': 2
      },
      diretoria: {
        'Desenvolvimento Comercial': 26, Marketing: 20, BIC: 15, Vendas: 10,
        Financeiro: 9, Industrial: 9, Log√≠stica: 8, RH: 7, Comercial: 5, F√°brica: 3, 'Supply Chain': 3, Outros: 13
      },
      diversidade: { Mulheres: 13, 'Negros/Pardos': 17, PCD: 0, '50+': 5 }
    };

    // ====== PALETA NOVA ======
    const colors = {
      primary: ['#7c3aed','#06b6d4','#0ea5e9','#22c55e','#eab308','#ef4444'], // violeta, ciano, azul, verde, amarelo, vermelho
      primarySoft: ['#ede9fe','#ecfeff','#e0f2fe','#dcfce7','#fef9c3','#fee2e2'],
      success: '#16a34a',
      warning: '#f59e0b',
      error:   '#ef4444'
    };

    // ====== GRAF: Status das Requisi√ß√µes (doughnut) ======
    new Chart(document.getElementById('statusReqChart'), {
      type: 'doughnut',
      data: {
        labels: Object.keys(data.statusRequisicao),
        datasets: [{
          data: Object.values(data.statusRequisicao),
          backgroundColor: colors.primary,
          borderWidth: 2,
          borderColor: '#fff'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '55%',
        plugins: {
          legend: { position: 'bottom', labels: { padding: 12, font: { size: 11 } } }
        }
      }
    });

    // ====== GRAF: Status dos Processos (pie) ======
    new Chart(document.getElementById('statusProcChart'), {
      type: 'pie',
      data: {
        labels: Object.keys(data.statusProcesso),
        datasets: [{
          data: Object.values(data.statusProcesso),
          backgroundColor: [
            '#7c3aed','#06b6d4','#0ea5e9','#22c55e','#eab308','#ef4444',
            '#8b5cf6','#14b8a6','#38bdf8','#34d399','#fbbf24','#f87171'
          ],
          borderWidth: 2,
          borderColor: '#fff'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'bottom', labels: { padding: 12, font: { size: 11 } } }
        }
      }
    });

    // ====== GRAF: Vagas por Local (bar) ======
    new Chart(document.getElementById('localChart'), {
      type: 'bar',
      data: {
        labels: Object.keys(data.local),
        datasets: [{
          label: 'Quantidade de Vagas',
          data: Object.values(data.local),
          backgroundColor: '#06b6d4',
          borderColor: '#0891b2',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: { beginAtZero: true, ticks: { stepSize: 10 }, grid: { color: '#eef0f4' } },
          x: { grid: { display:false } }
        },
        plugins: { legend: { display:false } }
      }
    });

    // ====== GRAF: Perfil das Vagas (polarArea) ======
    new Chart(document.getElementById('nivelChart'), {
      type: 'polarArea',
      data: {
        labels: Object.keys(data.nivel),
        datasets: [{
          data: Object.values(data.nivel),
          backgroundColor: ['#ede9fe','#ecfeff','#e0f2fe','#dcfce7','#fef9c3','#fee2e2',
                            '#f3e8ff','#cffafe','#bae6fd','#bbf7d0','#fde68a','#fecaca'],
          borderColor:   ['#7c3aed','#06b6d4','#0ea5e9','#22c55e','#eab308','#ef4444',
                          '#8b5cf6','#14b8a6','#38bdf8','#34d399','#fbbf24','#f87171'],
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { position: 'right', labels: { font: { size: 10 } } } },
        scales: { r: { grid: { color:'#eef0f4' } } }
      }
    });

    // ====== GRAF: Diretorias (horizontal bar) ======
    new Chart(document.getElementById('diretoriaChart'), {
      type: 'bar',
      data: {
        labels: Object.keys(data.diretoria),
        datasets: [{
          label: 'N√∫mero de Vagas',
          data: Object.values(data.diretoria),
          backgroundColor: [
            '#7c3aed','#06b6d4','#0ea5e9','#22c55e','#eab308','#ef4444',
            '#8b5cf6','#14b8a6','#38bdf8','#34d399','#fbbf24','#f87171'
          ],
          borderWidth: 0
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { beginAtZero:true, ticks:{ stepSize:5 }, grid:{ color:'#eef0f4' } },
          y: { grid:{ display:false } }
        },
        plugins: { legend: { display:false } }
      }
    });

    // ====== GRAF: Diversidade (comparativo metas) ======
    new Chart(document.getElementById('diversityChart'), {
      type: 'bar',
      data: {
        labels: ['Mulheres', 'Ra√ßa', 'PCD', '50+'],
        datasets: [
          {
            label: 'Contrata√ß√µes',
            data: [13, 17, 0, 5],
            backgroundColor: ['#7c3aed','#06b6d4','#ef4444','#eab308'],
            borderWidth: 0
          },
          {
            label: 'Meta',
            data: [30, 20, 5, 10],
            backgroundColor: '#e5e7eb',
            borderColor: '#cbd5e1',
            borderWidth: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: { beginAtZero:true, max:35, ticks:{ stepSize:5 }, grid:{ color:'#eef0f4' } },
          x: { grid:{ display:false } }
        },
        plugins: { legend: { position: 'bottom' } }
      }
    });
  </script>
</body>
</html>
