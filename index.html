<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Indicadores A&S - Pierre Fabre 2025</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">

  <!-- Libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    :root{
      /* Paleta neutra + acentos */
      --bg: #f7f7fb;
      --surface: #ffffff;
      --surface-2: #f1f1f6;
      --text: #1f2937;        /* slate-800 */
      --muted: #6b7280;       /* slate-500 */
      --border: #e5e7eb;      /* gray-200 */

      --accent: #6d28d9;      /* violet-700 */
      --accent-600: #7c3aed;  /* violet-600 */
      --accent-500: #8b5cf6;  /* violet-500 */
      --accent-300: #c4b5fd;  /* violet-300 */
      --accent-100: #ede9fe;  /* violet-100 */

      --good: #16a34a;        /* green-600 */
      --warn: #f59e0b;        /* amber-500 */
      --bad:  #ef4444;        /* red-500 */

      --radius-lg: 16px;
      --radius-md: 12px;
      --shadow-1: 0 6px 20px rgba(0,0,0,.06);
      --shadow-2: 0 10px 30px rgba(0,0,0,.08);
    }

    /* Dark mode autom√°tico */
    @media (prefers-color-scheme: dark){
      :root{
        --bg: #0b0d12;
        --surface: #111418;
        --surface-2: #151a20;
        --text: #e5e7eb;
        --muted: #a1a1aa;
        --border: #1f242b;

        --shadow-1: 0 6px 22px rgba(0,0,0,.35);
        --shadow-2: 0 18px 40px rgba(0,0,0,.45);
      }
    }

    *{ box-sizing: border-box; margin:0; padding:0; }
    html,body{ height:100%; }
    body{
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: radial-gradient(1000px 600px at 10% -10%, var(--accent-100), transparent 60%),
                  radial-gradient(800px 500px at 110% 10%, var(--accent-100), transparent 55%),
                  var(--bg);
      color: var(--text);
      padding: 24px;
    }

    .print-button{
      position: fixed; top: 18px; right: 18px;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 10px 18px;
      border-radius: 999px;
      font-weight: 600; font-size: 14px;
      cursor: pointer;
      box-shadow: var(--shadow-1);
      transition: transform .15s ease, box-shadow .2s ease, border-color .2s ease;
      z-index: 1000;
    }
    .print-button:hover{ transform: translateY(-2px); box-shadow: var(--shadow-2); border-color: var(--accent-300);}
    @media print{ .print-button{ display:none } body{ background: #fff } }

    .header{
      max-width: 1200px; margin: 0 auto 28px;
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      border: 1px solid var(--border);
      border-radius: calc(var(--radius-lg) + 4px);
      box-shadow: var(--shadow-1);
      padding: 28px 28px 24px;
      text-align: left;
    }
    .brand{
      display:flex; align-items:center; gap:14px; margin-bottom:12px;
    }
    .logo{
      width: 44px; height: 44px; border-radius: 10px;
      background: linear-gradient(135deg, var(--accent-600), var(--accent));
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.15);
    }
    .brand h1{
      font-size: 15px; font-weight: 700; letter-spacing: .12em; text-transform: uppercase;
      color: var(--muted);
    }
    .title{
      display:flex; flex-wrap:wrap; align-items:baseline; gap:10px;
    }
    .title h2{ font-size: 32px; font-weight: 800; letter-spacing: -0.02em; }
    .title .pill{
      font-size: 13px; font-weight: 600; color: var(--accent);
      background: var(--accent-100); border: 1px solid var(--border);
      padding: 6px 10px; border-radius: 999px;
    }
    .subhead{
      margin-top:6px; color: var(--muted); font-size: 14px;
    }

    .dashboard-container{ max-width: 1200px; margin: 0 auto; }

    .section-title{
      margin: 28px 0 14px;
      font-size: 18px; font-weight: 700; letter-spacing: .02em;
      display:flex; align-items:center; gap:10px;
      color: var(--text);
    }
    .section-title::before{
      content:'';
      display:inline-block; width:10px; height:10px; border-radius:3px;
      background: linear-gradient(135deg, var(--accent-600), var(--accent-300));
      box-shadow: 0 0 0 4px var(--accent-100);
    }

    .metrics-grid{
      display:grid; gap:18px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      margin-bottom: 18px;
    }

    .metric-card{
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-1);
      padding: 18px;
      transition: transform .15s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .metric-card:hover{ transform: translateY(-2px); box-shadow: var(--shadow-2); border-color: var(--accent-100); }
    .metric-card h3{
      font-size: 14px; font-weight: 700; letter-spacing:.02em;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .chart-container{ position: relative; width: 100%; height: 300px; }

    .stat-grid{
      display:grid; gap:14px;
      grid-template-columns: repeat(auto-fit, minmax(160px,1fr));
    }
    .stat{
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding:16px;
      text-align:left;
    }
    .stat .label{ font-size:12px; color:var(--muted); font-weight:600; letter-spacing:.06em; text-transform: uppercase;}
    .stat .value{ margin-top:6px; font-size:30px; font-weight:800; letter-spacing: -0.02em; }

    .table-container{ overflow-x:auto; margin-top:8px; }
    table{ width:100%; border-collapse: collapse; font-size: 14px; }
    th,td{ padding:12px 10px; border-bottom:1px solid var(--border); }
    th{
      text-align:left; font-weight:700; color:var(--text);
      background: linear-gradient(180deg, var(--surface-2), var(--surface));
      position: sticky; top:0; z-index:1;
    }
    tr:hover td{ background: rgba(139,92,246,.06); }

    .diversity-indicators{
      display:flex; flex-wrap:wrap; gap:16px; padding:4px;
    }
    .diversity-item{
      flex:1; min-width: 160px;
      display:flex; align-items:center; gap:12px;
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      border:1px solid var(--border);
      border-radius: var(--radius-md);
      padding:12px 14px;
    }
    .diversity-badge{
      width:42px; height:42px; border-radius:10px;
      background: linear-gradient(135deg, var(--accent-600), var(--accent));
      display:grid; place-items:center; color:#fff; font-size:18px; font-weight:700;
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.14);
    }
    .diversity-text .val{ font-weight:800; font-size:22px; letter-spacing:-.02em; }
    .diversity-text .lbl{ color:var(--muted); font-size:12px; text-transform: uppercase; letter-spacing:.06em; }
    .diversity-text .note{ margin-top:2px; font-size:12px; color:var(--accent-600); font-weight:600; }

    @media print{
      body{ padding:0; background:#fff; }
      .header{ box-shadow:none; }
      .metric-card{ break-inside: avoid; }
    }
  </style>
</head>
<body>
  <button class="print-button" onclick="window.print()">üìÑ Exportar PDF</button>

  <header class="header">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1>PIERRE FABRE</h1>
    </div>
    <div class="title">
      <h2>Indicadores A&amp;S</h2>
      <span class="pill">Processos Seletivos ¬∑ 2025</span>
    </div>
    <p class="subhead">Atualizado em: Outubro 2025</p>
  </header>

  <main class="dashboard-container">
    <!-- Resumo Executivo -->
    <section>
      <h3 class="section-title">üìä Resumo Executivo</h3>
      <div class="stat-grid">
        <div class="stat"><div class="label">Total de Vagas</div><div class="value">128</div></div>
        <div class="stat"><div class="label">Contrata√ß√µes</div><div class="value">93</div></div>
        <div class="stat"><div class="label">Taxa de Convers√£o</div><div class="value">72,7%</div></div>
        <div class="stat"><div class="label">Em Andamento</div><div class="value">16</div></div>
      </div>
    </section>

    <!-- Volumetria dos Processos -->
    <section>
      <h3 class="section-title">üìà Volumetria dos Processos</h3>
      <div class="metrics-grid">
        <div class="metric-card">
          <h3>Status das Requisi√ß√µes</h3>
          <div class="chart-container"><canvas id="statusReqChart"></canvas></div>
        </div>
        <div class="metric-card">
          <h3>Status dos Processos</h3>
          <div class="chart-container"><canvas id="statusProcChart"></canvas></div>
        </div>
        <div class="metric-card">
          <h3>Vagas por Local</h3>
          <div class="chart-container"><canvas id="localChart"></canvas></div>
        </div>
        <div class="metric-card">
          <h3>Perfil das Vagas</h3>
          <div class="chart-container"><canvas id="nivelChart"></canvas></div>
        </div>
      </div>
    </section>

    <!-- Distribui√ß√£o por Diretoria -->
    <section>
      <h3 class="section-title">üè¢ Distribui√ß√£o por Diretoria</h3>
      <div class="metric-card">
        <h3>Top 10 Diretorias com Mais Vagas</h3>
        <div class="chart-container" style="height: 400px;"><canvas id="diretoriaChart"></canvas></div>
      </div>
    </section>

    <!-- Diversidade e Inclus√£o -->
    <section>
      <h3 class="section-title">üåà Diversidade e Inclus√£o</h3>
      <div class="metric-card">
        <h3>Indicadores de Diversidade nas Contrata√ß√µes</h3>
        <div class="diversity-indicators">
          <div class="diversity-item">
            <div class="diversity-badge">‚ôÄ</div>
            <div class="diversity-text">
              <div class="val">13</div>
              <div class="lbl">Mulheres</div>
              <div class="note">14% do total</div>
            </div>
          </div>
          <div class="diversity-item">
            <div class="diversity-badge">ü§ù</div>
            <div class="diversity-text">
              <div class="val">17</div>
              <div class="lbl">Ra√ßa</div>
              <div class="note">18,3% do total</div>
            </div>
          </div>
          <div class="diversity-item">
            <div class="diversity-badge">‚ôø</div>
            <div class="diversity-text">
              <div class="val">0</div>
              <div class="lbl">PCD</div>
              <div class="note" style="color:var(--bad)">0% do total</div>
            </div>
          </div>
          <div class="diversity-item">
            <div class="diversity-badge">50+</div>
            <div class="diversity-text">
              <div class="val">5</div>
              <div class="lbl">Faixa Et√°ria</div>
              <div class="note">5,4% do total</div>
            </div>
          </div>
        </div>

        <div class="chart-container" style="height: 320px; margin-top: 18px;">
          <canvas id="diversityChart"></canvas>
        </div>
      </div>
    </section>

    <!-- An√°lise Detalhada -->
    <section>
      <h3 class="section-title">üìã An√°lise Detalhada</h3>
      <div class="metrics-grid">
        <div class="metric-card">
          <h3>Taxa de Aprova√ß√£o por Status</h3>
          <div class="table-container">
            <table>
              <thead>
                <tr><th>Status</th><th>Quantidade</th><th>Percentual</th></tr>
              </thead>
              <tbody>
                <tr><td>Contratada</td><td>93</td><td>72,7%</td></tr>
                <tr><td>Congelada</td><td>16</td><td>12,5%</td></tr>
                <tr><td>Cancelada</td><td>16</td><td>12,5%</td></tr>
                <tr><td>Decl√≠nio de Oferta</td><td>2</td><td>1,6%</td></tr>
                <tr><td>Em Processo</td><td>1</td><td>0,8%</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="metric-card">
          <h3>Principais M√©tricas de Performance</h3>
          <div class="table-container">
            <table>
              <thead>
                <tr><th>M√©trica</th><th>Valor</th><th>Meta</th><th>Status</th></tr>
              </thead>
              <tbody>
                <tr><td>Taxa de Convers√£o</td><td>72,7%</td><td>70%</td><td style="color:var(--good);font-weight:700">‚úì Atingido</td></tr>
                <tr><td>Diversidade G√™nero</td><td>14%</td><td>30%</td><td style="color:var(--warn);font-weight:700">‚ö† Em progresso</td></tr>
                <tr><td>Inclus√£o PCD</td><td>0%</td><td>5%</td><td style="color:var(--bad);font-weight:700">‚úó Abaixo da meta</td></tr>
                <tr><td>Taxa de Cancelamento</td><td>12,5%</td><td>15%</td><td style="color:var(--good);font-weight:700">‚úì Dentro do esperado</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Tipografia global dos gr√°ficos
    Chart.defaults.font.family = "'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif";
    Chart.defaults.plugins.legend.labels.usePointStyle = true;
    Chart.defaults.plugins.legend.labels.boxWidth = 10;

    // Paleta coerente com o CSS
    const palette = {
      violet700: "#6d28d9",
      violet600: "#7c3aed",
      violet500: "#8b5cf6",
      violet300: "#c4b5fd",
      gray600:   "#4b5563",
      gray300:   "#d1d5db",
      green600:  "#16a34a",
      amber500:  "#f59e0b",
      red500:    "#ef4444",
      slate800:  "#1f2937"
    };

    // Dados (mesmos do original)
    const data = {
      statusRequisicao: { Aprovada: 56, Cancelada: 4, Preenchida: 68 },
      statusProcesso: { Contratada: 93, Congelada: 16, Cancelada: 16, 'Decl√≠nio de carta oferta': 2, 'Em Processo': 1 },
      local: { Escrit√≥rio: 72, Campo: 29, BIC: 13, F√°brica: 12, 'N√£o especificado': 2 },
      nivel: { Est√°gio: 41, Analista: 27, Vendas: 19, Gerencial: 12, Especialista: 10, 'Jovem Aprendiz': 10, 'Supervis√£o/Coordena√ß√£o': 6, 'Demais vagas': 1, 'N√£o especificado': 2 },
      diretoria: { 'Desenvolvimento Comercial': 26, Marketing: 20, BIC: 15, Vendas: 10, Financeiro: 9, Industrial: 9, Log√≠stica: 8, RH: 7, Comercial: 5, F√°brica: 3, 'Supply Chain': 3, Outros: 13 },
      diversidade: { Mulheres: 13, 'Negros/Pardos': 17, PCD: 0, '50+': 5 }
    };

    // Helpers visuais
    const ringColors = [palette.violet700, palette.violet600, palette.violet500, palette.violet300, palette.gray300, palette.gray600];
    const altColors  = [palette.violet600, palette.violet500, palette.violet300, palette.gray600, palette.gray300, palette.violet700];

    // Doughnut ‚Äì Status das Requisi√ß√µes
    new Chart(document.getElementById('statusReqChart'), {
      type: 'doughnut',
      data: {
        labels: Object.keys(data.statusRequisicao),
        datasets: [{
          data: Object.values(data.statusRequisicao),
          backgroundColor: ringColors,
          borderColor: "#fff",
          borderWidth: 2,
          hoverOffset: 6
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '62%',
        plugins: {
          legend: { position: 'bottom', labels: { padding: 14, font: { size: 12 }} },
          tooltip: { callbacks:{ label: c => `${c.label}: ${c.parsed}` } }
        }
      }
    });

    // Pie ‚Äì Status dos Processos
    new Chart(document.getElementById('statusProcChart'), {
      type: 'pie',
      data: {
        labels: Object.keys(data.statusProcesso),
        datasets: [{
          data: Object.values(data.statusProcesso),
          backgroundColor: altColors,
          borderColor: "#fff",
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'bottom', labels: { padding: 14, font: { size: 12 } } }
        }
      }
    });

    // Bar ‚Äì Vagas por Local
    new Chart(document.getElementById('localChart'), {
      type: 'bar',
      data: {
        labels: Object.keys(data.local),
        datasets: [{
          label: 'Quantidade de Vagas',
          data: Object.values(data.local),
          backgroundColor: palette.violet600,
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { grid: { display:false } },
          y: {
            beginAtZero: true,
            ticks: { stepSize: 10 },
            grid: { color: 'rgba(0,0,0,.06)' }
          }
        },
        plugins: { legend: { display:false } }
      }
    });

    // Polar Area ‚Äì Perfil das Vagas
    new Chart(document.getElementById('nivelChart'), {
      type: 'polarArea',
      data: {
        labels: Object.keys(data.nivel),
        datasets: [{
          data: Object.values(data.nivel),
          backgroundColor: [
            palette.violet700 + 'dd', palette.violet600 + 'dd', palette.violet500 + 'dd',
            palette.violet300 + 'dd', palette.gray600 + 'dd',   palette.gray300 + 'dd',
            '#9ca3afdd', '#cbd5e1dd', '#818cf8dd'
          ],
          borderColor: 'rgba(255,255,255,.9)',
          borderWidth: 2
        }]
      },
      options: {
        responsive:true,
        maintainAspectRatio:false,
        plugins:{ legend:{ position:'right', labels:{ font:{ size:11 } } } },
        scales:{ r:{ grid:{ color:'rgba(0,0,0,.06)' } } }
      }
    });

    // Horizontal Bar ‚Äì Diretorias
    new Chart(document.getElementById('diretoriaChart'), {
      type: 'bar',
      data: {
        labels: Object.keys(data.diretoria),
        datasets: [{
          label: 'N√∫mero de Vagas',
          data: Object.values(data.diretoria),
          backgroundColor: Object.values(data.diretoria).map((_,i)=> i%2? palette.violet600: palette.violet500),
          borderRadius: 8
        }]
      },
      options: {
        indexAxis: 'y',
        responsive:true,
        maintainAspectRatio:false,
        scales:{
          y:{ grid:{ display:false } },
          x:{ beginAtZero:true, ticks:{ stepSize:5 }, grid:{ color:'rgba(0,0,0,.06)' } }
        },
        plugins:{ legend:{ display:false } }
      }
    });

    // Grupo ‚Äì Diversidade
    new Chart(document.getElementById('diversityChart'), {
      type: 'bar',
      data: {
        labels: ['Mulheres','Ra√ßa','PCD','50+'],
        datasets: [
          { label:'Contrata√ß√µes', data:[13,17,0,5], backgroundColor: [palette.violet600, palette.violet500, palette.red500, palette.amber500], borderRadius: 8 },
          { label:'Meta', data:[30,20,5,10], backgroundColor: 'rgba(15,23,42,.12)', borderRadius: 8 }
        ]
      },
      options:{
        responsive:true,
        maintainAspectRatio:false,
        scales:{
          y:{ beginAtZero:true, max:35, ticks:{ stepSize:5 }, grid:{ color:'rgba(0,0,0,.06)' } },
          x:{ grid:{ display:false } }
        },
        plugins:{ legend:{ position:'bottom' } }
      }
    });
  </script>
</body>
</html>
